"use strict";var initKapital=function(){document.querySelectorAll(".formWACC").forEach((function(e){var t=e.getAttribute("id");e.addEventListener("submit",(function(e){e.preventDefault(),sweet2.loading();var n=new FormData(e.target),a=t?"/kapital/"+t+"/update":"/kapital/store";helper.post(a,n).then((function(e){var n=e.success,a=e.data,o=e.message;if(!n)throw o;setTimeout((function(){t?(window.AppFinanceWeb.modules.forEach((function(e){e.$mount()})),sweet2.success({text:o})):window.location.href="/kapital/"+a.uid+"/resultados"}),2500)})).catch((function(e){console.log(e),sweet2.show({type:"error",html:e})}))}))}));var e=document.getElementById("pdFormInput");e&&e.addEventListener("keyup",(function(e){var t=e.target.value,n=0;Number(t)<=100&&(n=100-t);var a=document.getElementById("pcFormInput");a&&(a.value=n)})),$("#countryFormInput").on("select2:select",(function(e){var t=e.params.data.text,n=document.getElementById("dateFormInput"),a=document.getElementById("taxFormInput"),o=document.getElementById("devaluationFormInput");if(o&&(o.value="Peru"==t?"1.64":""),n&&n.value.length>0){a.value="Cargando...";var r=n.value.split("/").pop(),i=new FormData,c=window.AppFinanceWeb.uid;i.append("country",t),i.append("year",r),i.append("uid",c),helper.post("/kapital/taxrate",i).then((function(e){var t=e.success,n=e.data,o=e.message;if(!t)throw o;a&&(a.value=n.param.taxrate)})).catch((function(e){a&&(a.value=""),console.log(e),sweet2.show({type:"error",html:e})}))}}))};function collapseFaToggle(e,t){var n=document.getElementById(t),a=document.getElementsByName("companyInput");e.classList.contains("collapsed")?(n&&(n.classList.add("fa-toggle-off"),n.classList.remove("fa-toggle-on")),a&&a.forEach((function(e){e.removeAttribute("required")}))):n&&(n.classList.add("fa-toggle-on"),n.classList.remove("fa-toggle-off"),a&&a.forEach((function(e){e.addAttribute("required")})))}var initValora=function(){document.querySelectorAll(".formInputValora").forEach((function(e){var t=e.getAttribute("id");e.addEventListener("submit",(function(e){e.preventDefault(),t?sweet2.loading():sweet2.loading({text:"Estamos procensando su información, nos tomará algunos minutos en realizarlo. Cargando..."});var n=new FormData(e.target);!function(e,t){var n=e?"/valora/"+e+"/update":"/valora/store";helper.post(n,t).then((function(t){var n=t.success,a=t.data,o=t.message;if(!n)throw o;sweet2.success({text:o}),setTimeout((function(){sweet2.loading({text:"Redirigiendo a resultados..."}),window.location.href=e?"/valora/"+e+"/resultados":"/valora/"+a.uid+"/resultados"}),2e3)})).catch((function(e){sweet2.show({type:"error",html:e})}))}(t,n)}))})),document.querySelectorAll(".formTemplateUserValora").forEach((function(e){var t=e.getAttribute("uid");e.addEventListener("submit",(function(e){e.preventDefault(),t?sweet2.loading({text:"Estamos procensando su información, nos tomará algunos minutos en realizarlo. Cargando..."}):sweet2.loading();var n=new FormData(e.target);n.append("uid",t),helper.post(window.AppFinanceWeb.api+"/api/valora/upload",n).then((function(n){var a=n.success,o=n.data,r=n.message;if(!a)throw r;var i=window.AppFinanceWeb.api,c=document.getElementById("fileUsername");c&&(c.value=o.filename);var s=document.getElementById("fileUsernameUrl");s&&s.setAttribute("href",i+o.fileurl);var l=document.getElementById("fileUsernameAlert");l&&l.classList.remove("d-none"),e.target.reset(),bootstrap.Modal.getOrCreateInstance(document.getElementById("modalFileUsername")).hide(),t&&setTimeout((function(){window.AppFinanceWeb.modules.forEach((function(e){e.$mount()}))}),2e3),sweet2.success({text:r})})).catch((function(e){sweet2.show({type:"error",html:e})}))}))}))},initFinance=function(){var e=document.querySelectorAll(".check-report"),t=document.querySelectorAll(".checkform");e.forEach((function(e){e.addEventListener("change",(function(e){var n=e.target,a=n.value,o=n.checked;t.forEach((function(e,t){if(e.classList.remove("text-primary"),o)switch(a.trim()){case"reporte-datos":[0,1].includes(t)&&e.classList.add("text-primary");break;case"reporte-detallado":[0,1,2].includes(t)&&e.classList.add("text-primary");break;case"consultoria-especializada":[0,1,2,3].includes(t)&&e.classList.add("text-primary")}}))}))}));var n=function(e,t){var n=e.split(".").pop().toLowerCase(),a='<div class="col"><h3>'.concat(t,"</h3></div>"),o='<div class="alert alert-warning" role="alert">\n                                Si aún no puede visualizar el contenido, <b><a href="'.concat(e,'" target="_blank" > click aquí para Descargar Archivo </a></b> y espere unos segundos.\n                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n                                    <span aria-hidden="true">&times;</span>\n                                </button>\n                            </div>');return["doc","docx","xlsx","xls","pptx","ppt","pdf","mpp","ppsx","xlsm","pptm"].includes(n)?"".concat(a).concat(o,"\n                <div class='col' style='height:100%'>\n                    <div id=\"warning-iframe-no-loaded\" class=\"alert alert-warning\" role=\"alert\">\n                        Si aún no puede visualizar el contenido , por favor haga <b><a href='' onclick=\"return window.realoadIframe(this, '#iframeA001','https://docs.google.com/viewer?url=").concat(e,"&embedded=true')\" >clic aquí</a></b> y espere unos segundos.\n                        <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n                        <span aria-hidden=\"true\">&times;</span>\n                        </button>\n                    </div>\n                    <iframe name='destinoA' onload='window.removeReloadAlertIframeNoLoaded()' width='100%'  height='100%' id='iframeA001' src='https://docs.google.com/viewer?url=").concat(e,"&embedded=true' scrolling='hidden'  frameborder='0px' cellSpacing='0' cellPadding='0'  target='_self'>\n                        Tu Navegador no esta configurado para soportar estos frames\n                    </iframe>\n                </div>"):["mp4"].includes(n)?'<div class="col">\n                        '.concat(a,'\n                        <video width="100%" height="100%" controls>\n                            <source src="').concat(e,'" type="video/').concat(n,'">\n                            Your browser does not support the video tag.\n                        </video>\n                    </div>'):["jpg","jpeg","png","gif"].includes(n)?'<div class="col">'.concat(a,'<img src="').concat(e,'" alt="Imagen" width="100%" height="100%"></div>'):"<div class='col' style='height:100%'>".concat(e,"</div>")},a=document.querySelectorAll(".btnviewfile"),o=document.querySelector("#containerviewer");a.forEach((function(e,t){var a=e.getAttribute("d-url"),r=e.getAttribute("d-name");e.addEventListener("click",(function(e){o&&(o.innerHTML=n(a,r))})),0==t&&o&&(o.innerHTML=n(a,r))})),window.removeReloadAlertIframeNoLoaded=function(){$("#warning-iframe-no-loaded").remove()},window.realoadIframe=function(e,t,n){return $(t).attr("src",n),!1};!function(){var e,t,n,a,o="AppReportKapitalWeb";if(document.getElementById(o)){var r=(e={scope:o,uid:window.AppFinanceWeb.uid},t=e.scope,n=e.uid,a={},new Vue({el:"#"+t,data:function(){return{designs:[],design_contents:[],loading:!0,all_checked:!1}},created:function(){a=this},mounted:function(){a.initialize()},watch:{},computed:{},methods:{initialize:function(){a.onList()},onList:function(){a.loading=!0,helper.post("/kapital/"+n+"/reportes/list").then((function(e){var t=e.success,n=e.data,o=e.message;if(!t)throw o;console.log({data:n}),a.designs=n.designs,a.design_contents=n.design_contents,a.loading=!1,setTimeout((function(){a.onContentEvent()}),500)})).catch((function(e){console.log(e),sweet2.error({html:e})}))},onFormReport:function(e){if(e.preventDefault(),a.all_checked)return bootstrap.Modal.getOrCreateInstance(document.getElementById("kt_modal_cotizar")).show();var t=new FormData(e.target).get("report");sweet2.loading(),window.location.href="/kapital/".concat(n,"/reportes/").concat(t)},onContentEvent:function(){var e=document.querySelectorAll("input[name=report]"),t=document.querySelectorAll(".checkform");e.forEach((function(e){e.addEventListener("change",(function(e){var n=e.target,o=n.getAttribute("data-content-id"),r=(n.value,n.checked);t.forEach((function(e,t){if(e.classList.remove("text-primary"),r)switch(Number(o)){case 1:[0].includes(t)&&(e.classList.add("text-primary"),a.all_checked=!1);break;case 2:[0,1].includes(t)&&(e.classList.add("text-primary"),a.all_checked=!1);break;case 3:[0,1,2].includes(t)&&(e.classList.add("text-primary"),a.all_checked=!0)}}))}))}))},onQuote:function(){}}}));window.AppFinanceWeb.modules.push(r)}}(),function(){var e,t,n,a,o="AppReportValoraWeb";if(document.getElementById(o)){var r=(e={scope:o,uid:window.AppFinanceWeb.uid},t=e.scope,n=e.uid,a={},new Vue({el:"#"+t,data:function(){return{designs:[],design_contents:[],loading:!0,all_checked:!1}},created:function(){a=this},mounted:function(){a.initialize()},watch:{},computed:{},methods:{initialize:function(){a.onList()},onList:function(){a.loading=!0,helper.post("/valora/"+n+"/reportes/list").then((function(e){var t=e.success,n=e.data,o=e.message;if(!t)throw o;console.log({data:n}),a.designs=n.designs,a.design_contents=n.design_contents,a.loading=!1,setTimeout((function(){a.onContentEvent()}),500)})).catch((function(e){console.log(e),sweet2.error({html:e})}))},onFormReport:function(e){if(e.preventDefault(),a.all_checked)return bootstrap.Modal.getOrCreateInstance(document.getElementById("kt_modal_cotizar")).show();var t=new FormData(e.target).get("report");sweet2.loading(),window.location.href="/valora/".concat(n,"/reportes/").concat(t)},onContentEvent:function(){var e=document.querySelectorAll("input[name=report]"),t=document.querySelectorAll(".checkform");e.forEach((function(e){e.addEventListener("change",(function(e){var n=e.target,o=n.getAttribute("data-content-id"),r=(n.value,n.checked);t.forEach((function(e,t){if(e.classList.remove("text-primary"),r)switch(Number(o)){case 1:[0].includes(t)&&(e.classList.add("text-primary"),a.all_checked=!1);break;case 2:[0,1].includes(t)&&(e.classList.add("text-primary"),a.all_checked=!1);break;case 3:[0,1,2].includes(t)&&(e.classList.add("text-primary"),a.all_checked=!0)}}))}))}))}}}));window.AppFinanceWeb.modules.push(r)}}()};document.addEventListener("DOMContentLoaded",(function(){initFinance(),initKapital(),initValora()}));