"use strict";var AppProfileAdmin={account:function(t){var n={};return new Vue({el:"#"+t,data:function(){return{loadAccount:!1,account:{},status:!1}},created:function(){n=this},mounted:function(){n.initialize()},watch:{},computed:{},methods:{initialize:function(){n.onAccount()},onAccount:function(){var t=new FormData;t.append("domain",location.host),window.helper.post("/admin/empresa/microsoft",t).then((function(t){if(!t.success)throw t.message;n.account=t.data.account,n.status=t.data.status,n.loadAccount=!0})).catch((function(t){n.loadAccount=!0,sweet2.error({html:t})}))},onToggleAccount:function(t){t.preventDefault();var n=t.target.checked;n?sweet2.question({title:"¿Estás seguro de vincular tu cuenta?",onOk:function(){sweet2.loading(),$("<form>",{id:"frmAzure",html:' <input type="text" name="domain" value="'.concat(window.location.host,'"/>\n                                            <input type="text" name="redirect" value="').concat(window.location.protocol+"//"+window.location.host+"/admin/empresa",'" />/>'),action:window.AppMain.baseurl+"/microsoft/authurl",method:"post",class:"add-none"}).appendTo(document.body).submit(),$("#frmAzure").remove()},onCancel:function(){t.target.checked=!n}}):sweet2.question({title:"¿Estás seguro de desvincular tu cuenta?",text:"Se descronizará todos los flujos de trabajo que has realizado relacionado con tu cuenta",onOk:function(){sweet2.loading();var e=new FormData;e.append("domain",window.location.host),helper.post("/microsoft/signout",e).then((function(t){if(!t.success)throw t.message;sweet2.loading({text:t.message}),setTimeout((function(){window.location.reload()}),2e3)})).catch((function(e){sweet2.error({html:e}),t.target.checked=!n}))},onCancel:function(){t.target.checked=!n}})}}})},init:function(){var t="AppAccountExternalAdmin";document.getElementById(t)&&AppProfileAdmin.account(t)}};document.addEventListener("DOMContentLoaded",AppProfileAdmin.init());