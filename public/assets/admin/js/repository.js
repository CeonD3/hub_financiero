"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var AppFileAdmin={index:function(e){var t={},n=document.getElementById(e).getAttribute("data-id");return new Vue({el:"#"+e,data:function(){return _defineProperty(_defineProperty(_defineProperty(_defineProperty({repositories:[],accounts:[],account:{},users:[],user:{},meetings:[],meeting:{},recordings:[],recording:{},loading:!1,total:0,stacks:[],typeId:0,storage:{},storages:[],folders:[],breadcrumbs:[],folderShow:!1,parent:{}},"stacks",[]),"loadingStacks",!1),"typeIdStack",1),"childrens",[])},created:function(){t=this},mounted:function(){t.initialize()},watch:{},computed:{},methods:{initialize:function(){t.onAccounts(),t.onTranfers()},onStacks:function(){helper.post("/admin/repositorios/stacks").then((function(e){var t=e.success,n=e.data,r=e.message;if(!t)throw r;console.log(n)})).catch((function(e){sweet2.error({text:e})}))},onTranfers:function(){t.loadingStacks=!0;var e=new FormData;e.append("companyId",AppMain.companyId),e.append("userId",AppMain.userId),helper.post("/admin/repositorios/"+n+"/transfers",e).then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.stacks=r.stacks,t.loadingStacks=!1})).catch((function(e){sweet2.error({text:e}),t.loadingStacks=!1}))},onRemoveStack:function(e){sweet2.question({title:"¿Estás seguro de eliminar este elemento?",onOk:function(){sweet2.loading();var n=new FormData;window.helper.post("/admin/repositorios/stacks/"+e+"/remove",n).then((function(e){var n=e.success,r=e.message;if(!n)throw r;sweet2.success({text:r}),t.onTranfers()})).catch((function(e){sweet2.error({text:e})}))}})},onViewStack:function(e){t.childrens=[],sweet2.loading();var n=new FormData;window.helper.post("/admin/repositorios/stacks/"+e+"/childrens",n).then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.childrens=r.childrens,sweet2.loading(!1),bootstrap.Modal.getOrCreateInstance(document.getElementById("modalStackParent")).show()})).catch((function(e){sweet2.error({text:e})}))},onFormRepository:function(){try{var e,r,o,a,i;if(0==Object.keys(t.parent).length)throw"Debe seleccionar el almacenamiento de destino";var s=[],c=document.getElementsByClassName("items");if(c.forEach((function(e,t){e.checked&&(s=[].concat(_toConsumableArray(s),[e.value]))})),0==s.length)throw"Debe seleccionar un elemento";sweet2.loading();var d=new FormData;d.append("accountIdSender",null===(e=t.account)||void 0===e?void 0:e.id),d.append("userIdSender",null===(r=t.user)||void 0===r?void 0:r.id),d.append("folderIdSender",null===(o=t.meeting)||void 0===o?void 0:o.id),d.append("items",JSON.stringify(s)),d.append("accountIdReceiver",t.parent.account.id),d.append("folderIdReceiver",null===(a=t.parent)||void 0===a||null===(a=a.folder)||void 0===a?void 0:a.id),d.append("nameFileReceiver",null===(i=t.parent)||void 0===i||null===(i=i.folder)||void 0===i?void 0:i.name),d.append("companyId",AppMain.companyId),d.append("userId",AppMain.userId),d.append("typeIdStack",t.typeIdStack),helper.post("/admin/repositorios/"+n+"/transfer",d).then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;console.log(r),t.items=[],c.forEach((function(e,t){e.checked&&(e.checked=!1)})),t.onTranfers(),sweet2.success({text:o})})).catch((function(e){sweet2.error({text:e})}))}catch(e){sweet2.error({text:e})}},onTypeStack:function(e){t.typeIdStack=e.target.value,t.onAccounts()},onFormStorage:function(e){e.preventDefault();try{var n,r=new FormData(e.target),o=r.get("providerId"),a=r.get("folderId");if(!(o>0))throw"Debe seleccionar una nube de almacenamiento";if(!((null===(n=t.storage)||void 0===n?void 0:n.id)>0))throw"Debe seleccionar una cuenta";t.parent={repository:t.repositories.find((function(e){return e.id==o})),account:t.storage,folder:a?t.folders.find((function(e){return e.id==a})):{id:"",name:"raíz"}},bootstrap.Modal.getOrCreateInstance(document.getElementById("modalParentFile")).hide(),sweet2.success({text:"Se establecio el almacenamiento de destino"})}catch(e){sweet2.error({text:e})}},handleBreadcrumbs:function(e,n){for(var r=[],o=!0,a=0;a<t.breadcrumbs.length;a++){var i=t.breadcrumbs[a];if(r[a]=i,i.id==e.id){o=!1;break}}t.breadcrumbs=o?[].concat(_toConsumableArray(t.breadcrumbs),[{id:e.id,name:e.name,type:n}]):r},onAccountsReceiver:function(e){sweet2.loading();var n=new FormData;n.append("companyId",AppMain.companyId),n.append("userId",AppMain.userId),helper.post("/admin/repositorios/"+e+"/accounts",n).then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.folderShow=!1,t.folders=[],t.breadcrumbs=[],t.storages=r.accounts,sweet2.loading(!1)})).catch((function(e){sweet2.error({text:e})}))},onTypeAccount:function(e){var n=e.target;if(t.typeId=n.value,3===Number(t.typeId))t.onAccountsReceiver(t.typeId)},onChildrens:function(e){var n;console.log(e),t.storage=0==t.storages.length&&null!==(n=t.storage)&&void 0!==n&&n.id?t.storage:t.storages.find((function(t){return t.id==e})),t.onFolders()},onFolders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t.loading=!0,e.length>0&&t.folders.length>0){var n=t.folders.find((function(t){return t.id==e}));t.handleBreadcrumbs(n,2)}else t.handleBreadcrumbs(t.storage,1);sweet2.loading();var r=new FormData;r.append("accountId",t.storage.id),r.append("id",e),helper.post("/admin/onedrive/folders",r).then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.folderShow=!0,t.storages=[],t.folders=r.folders,t.loading=!1,sweet2.loading(!1)})).catch((function(e){t.loading=!1,sweet2.error({text:e})}))},onAccounts:function(){t.breadcrumbs=[],t.items=[],t.loading=!0;var e=new FormData;e.append("companyId",AppMain.companyId),e.append("userId",AppMain.userId),helper.post("/admin/repositorios/"+n+"/accounts",e).then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.clearAccounts(!0),t.clearUsers(!0),t.clearMeetings(!0),t.clearRecordings(!0),t.accounts=r.accounts,t.repositories=r.repositories,t.total=t.accounts.length,t.loading=!1})).catch((function(e){sweet2.error({text:e}),t.loading=!1}))},onUsers:function(e){var n;Number(e)>0&&(t.items=[],t.loading=!0,t.account=0==t.accounts.length&&null!==(n=t.account)&&void 0!==n&&n.id?t.account:t.accounts.find((function(t){return t.id==e})),helper.post("/admin/zoom/"+e+"/users").then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.clearAccounts(!1),t.clearUsers(!0),t.clearMeetings(!0),t.clearRecordings(!0),t.users=r.users,t.total=r.total_records,t.loading=!1})).catch((function(e){sweet2.error({text:e}),t.loading=!1})))},onMeetings:function(e){var n;t.items=[],t.loading=!0,t.user=0==t.users.length&&null!==(n=t.user)&&void 0!==n&&n.id?t.user:t.users.find((function(t){return t.id==e})),helper.post("/admin/zoom/"+t.account.id+"/users/"+e+"/meetings").then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.clearUsers(!1),t.clearMeetings(!0),t.clearRecordings(!0),t.meetings=r.meetings,t.total=r.total_records,t.loading=!1})).catch((function(e){sweet2.error({text:e}),t.loading=!1}))},onRecordings:function(e){var n;t.items=[],t.loading=!0,t.meeting=0==t.meetings.length&&null!==(n=t.meeting)&&void 0!==n&&n.id?t.meeting:t.meetings.find((function(t){return t.id==e})),helper.post("/admin/zoom/"+t.account.id+"/meetings/"+e+"/recordings").then((function(e){var n=e.success,r=e.data,o=e.message;if(!n)throw o;t.clearMeetings(!1),t.clearRecordings(!0),t.recordings=r.recording_files,t.total=r.recording_count,t.loading=!1})).catch((function(e){sweet2.error({text:e}),t.loading=!1}))},clearRecordings:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.recordings=[],e&&(t.recording={})},clearMeetings:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.meetings=[],e&&(t.meeting={})},clearUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.users=[],e&&(t.user={})},clearAccounts:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.accounts=[],e&&(t.account={})}}})},init:function(){var e="AppIndexFileAdmin";document.getElementById(e)&&AppFileAdmin.index(e)}};document.addEventListener("DOMContentLoaded",AppFileAdmin.init());